<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨æ´»å‹•ã‚«ã‚®é–‰ã‚æ‹…å½“ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</title>
    <!-- Tailwind CSS CDNã®èª­ã¿è¾¼ã¿ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Interãƒ•ã‚©ãƒ³ãƒˆã‚’é©ç”¨ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            user-select: none; /* ãƒ†ã‚­ã‚¹ãƒˆé¸æŠã‚’ç„¡åŠ¹åŒ– */
            -webkit-user-select: none; /* Safari/Chromeç”¨ */
            -moz-user-select: none;    /* Firefoxç”¨ */
            -ms-user-select: none;     /* IE/Edgeç”¨ */
        }

        /* ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®ã‚³ãƒ³ãƒ†ãƒŠã‚’ä¸­å¤®ã«é…ç½® */
        .roulette-container {
            position: relative;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            aspect-ratio: 1 / 1; /* æ­£æ–¹å½¢ã‚’ç¶­æŒ */
            max-width: 90vw;
            max-height: 90vh;
        }

        /* ã‚«ã‚¹ã‚¿ãƒ ãƒã‚¤ãƒ³ã‚¿ãƒ¼ (ä¸‰è§’å½¢ã®ãƒ”ãƒ³) */
        .pointer {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-bottom: 30px solid #ef4444; /* èµ¤ */
            z-index: 10;
        }

        /* ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®Canvas */
        #rouletteCanvas {
            border-radius: 9999px; /* çœŸå††ã«ã™ã‚‹ */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2), inset 0 0 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        /* çµæœã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        .result-text {
            animation: bounceIn 0.8s ease-out both;
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(-10px);
            }
            50% {
                opacity: 1;
                transform: scale(1.1) translateY(0);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                transform: scale(1);
            }
        }

        /* ï¼¿ */
        #hiddenCheatPanel {
            display: none;
        }

        /* --- é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«è­¦å‘Šã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ --- */
        #devToolsAlert {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(255, 0, 0, 0.95);
            z-index: 99999;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            animation: flashAlert 0.5s infinite alternate;
        }

        @keyframes flashAlert {
            from { background-color: rgba(220, 38, 38, 0.95); }
            to { background-color: rgba(153, 27, 27, 0.95); }
        }

        .alert-icon {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: shake 0.5s infinite;
        }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex flex-col items-center">

    <!-- è­¦å‘Šã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
    <div id="devToolsAlert">
        <div class="alert-icon">âš ï¸</div>
        <h1 class="text-4xl font-extrabold mb-4">è­¦å‘Š: ä¸æ­£ãªæ“ä½œã‚’æ¤œçŸ¥ã—ã¾ã—ãŸ</h1>
        <p class="text-xl font-bold">é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã®ä½¿ç”¨ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>ç›´ã¡ã«é–‰ã˜ã¦ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚</p>
        <p class="mt-8 text-sm opacity-80">System Security Alert: Code 403 - Access Denied</p>
    </div>

    <div class="max-w-4xl w-full">
        <h1 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">ğŸ” éƒ¨æ´»å‹•ã‚«ã‚®é–‰ã‚æ‹…å½“ ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ</h1>

        <!-- 1ç”»é¢ã«é›†ç´„ã•ã‚ŒãŸæ“ä½œã‚¨ãƒªã‚¢ -->
        <div class="bg-white p-6 rounded-xl shadow-lg mb-8 flex flex-col space-y-4">
            
            <h2 class="text-xl font-bold text-red-600">å‚åŠ éƒ¨å“¡ãƒªã‚¹ãƒˆ (å‡ºå¸­ç•ªå·)</h2>
            <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ã€‚æ•°å­—ã¨æ”¹è¡Œä»¥å¤–ã¯å…¥åŠ›ä¸å¯ -->
            <textarea id="memberInput" rows="3" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500 transition duration-150" placeholder="å‡ºå¸­ç•ªå·ã‚’ä¸€äººãšã¤æ”¹è¡Œã—ã¦å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹:&#10;1&#10;5&#10;18&#10;25ï¼‰"></textarea>
            
            <!-- ãƒªã‚¹ãƒˆæ“ä½œãƒœã‚¿ãƒ³ -->
            <div class="flex space-x-3">
                <button id="updateListButton" class="flex-1 px-4 py-2 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition duration-200 shadow-md">
                    ãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¦ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’ä½œæˆ
                </button>
                <button id="resetListButton" class="px-4 py-2 bg-gray-400 text-white font-semibold rounded-lg hover:bg-gray-500 transition duration-200 shadow-md">
                    ãƒªã‚»ãƒƒãƒˆ
                </button>
            </div>
            <p id="memberCount" class="text-sm text-gray-600">ç¾åœ¨ã®å€™è£œè€…æ•°: 0å</p>

            <!-- ï¼¿-->
            <div id="hiddenCheatPanel" class="border-t pt-4 mt-4 bg-yellow-50 p-4 rounded-lg shadow-inner">
                <h3 class="text-xl font-bold text-yellow-800 mb-3">ç•ªå·</h3>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 items-center">
                    <select id="hiddenCheatTarget" class="p-2 border border-gray-300 rounded-lg bg-white w-full sm:w-auto transition duration-150">
                        <option value="">ï¼ˆé¸æŠãªã—ï¼šãƒ©ãƒ³ãƒ€ãƒ ï¼‰</option>
                    </select>
                    <button id="setCheatButton" class="w-full sm:w-auto px-4 py-2 bg-indigo-500 text-white font-semibold rounded-lg hover:bg-indigo-600 transition duration-200 shadow-md">
                        ç•ªå·ã‚’ç¢ºå®š
                    </button>
                    <button id="resetCheatButton" class="w-full sm:w-auto px-4 py-2 bg-gray-500 text-white font-semibold rounded-lg hover:bg-gray-600 transition duration-200 shadow-md">
                        è¨­å®šã‚’è§£é™¤
                    </button>
                </div>
                <p id="cheatStatus" class="text-sm text-yellow-700 mt-2 font-medium"> ãƒ©ãƒ³ãƒ€ãƒ æŠ½é¸</p>
            </div>
        </div>

        <!-- ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã¨çµæœã‚¨ãƒªã‚¢ -->
        <div class="flex flex-col md:flex-row md:space-x-8">

            <!-- ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <div class="w-full md:w-1/2 flex justify-center items-center mb-8 md:mb-0">
                <div class="roulette-container w-full h-full max-w-sm">
                    <canvas id="rouletteCanvas" class="w-full h-full"></canvas>
                    <div class="pointer"></div>
                </div>
            </div>

            <!-- æ“ä½œãƒ»çµæœã‚¨ãƒªã‚¢ -->
            <div class="w-full md:w-1/2 flex flex-col justify-center bg-white p-6 rounded-xl shadow-lg space-y-4">
                <div id="statusMessage" class="text-lg text-gray-600 text-center">
                    ãƒªã‚¹ãƒˆã‚’æ›´æ–°ã—ã¦ã€æŠ½é¸ã‚’å§‹ã‚ã‚ˆã†ï¼
                </div>

                <button id="spinButton" disabled class="w-full px-8 py-4 bg-green-500 text-white text-xl font-bold rounded-lg shadow-xl hover:bg-green-600 transition duration-300 transform hover:scale-[1.02] disabled:bg-gray-400 disabled:shadow-none">
                    ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã™ï¼
                </button>

                <!-- æŠ½é¸çµæœè¡¨ç¤º  -->
                <div id="resultBox" class="text-center p-4 border-t-2 border-red-500 cursor-pointer hover:bg-red-50 transition duration-100">
                    <h3 class="text-2xl font-extrabold text-gray-800 mb-2">ğŸ‰ æœ¬æ—¥ã®ã‚«ã‚®é–‰ã‚æ‹…å½“è€… ğŸ‰</h3>
                    <p id="resultDisplay" class="text-4xl md:text-5xl font-extrabold text-red-700 h-16 flex items-center justify-center result-text"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let members = [];
        let canvas, ctx;
        let isSpinning = false;
        let rotationAngle = 0; // ç¾åœ¨ã®å›è»¢è§’åº¦ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³ï¼‰
        let spinVelocity = 0; // å›è»¢é€Ÿåº¦ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³/ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰
        
        // æ‘©æ“¦ä¿‚æ•°ã‚’èª¿æ•´ (0.95 -> 0.97): 
        const friction = 0.97; 
        const fullCircle = 2 * Math.PI;

        const colors = [
            '#ef4444', '#f97316', '#eab308', '#22c55e', '#06b6d4', '#3b82f6', '#8b5cf6', '#ec4899'
        ]; // Tailwindã®ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆã‚’å‚è€ƒã«
        
        // è£½ä½œè€…
        const EXCLUDED_NUMBERS = ['34', '36']; 
        let clickCount = 0; // ï¼¿
        let clickTimer;
        let forcedWinnerNumber = null; // ï¼¿
        let predeterminedWinner = null; // å½“é¸ç•ªå·
        
        // æœ€çµ‚åœæ­¢è§’åº¦ã‚’ä¿å­˜ã™ã‚‹å¤‰æ•°
        let finalStopAngle = 0; 
        
        // éŸ³å£°ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ï¼‰
        let audioCtx = null;
        let isAlertTriggered = false;

        // DOMè¦ç´ ã®å–å¾—
        const memberInput = document.getElementById('memberInput');
        const updateListButton = document.getElementById('updateListButton');
        const resetListButton = document.getElementById('resetListButton');
        const memberCount = document.getElementById('memberCount');
        const spinButton = document.getElementById('spinButton');
        const resultDisplay = document.getElementById('resultDisplay');
        const statusMessage = document.getElementById('statusMessage');
        const resultBox = document.getElementById('resultBox'); // ã‚¯ãƒªãƒƒã‚¯å¯¾è±¡
        
        // ï¼¿
        const hiddenCheatPanel = document.getElementById('hiddenCheatPanel');
        const hiddenCheatTarget = document.getElementById('hiddenCheatTarget');
        const setCheatButton = document.getElementById('setCheatButton');
        const resetCheatButton = document.getElementById('resetCheatButton');
        const cheatStatus = document.getElementById('cheatStatus');
        
        // è­¦å‘Šç”¨DOM
        const devToolsAlert = document.getElementById('devToolsAlert');


        /**
         * Canvasã®åˆæœŸåŒ–ã¨ã‚µã‚¤ã‚ºè¨­å®š
         */
        function initializeCanvas() {
            canvas = document.getElementById('rouletteCanvas');
            ctx = canvas.getContext('2d');

            const container = canvas.parentElement;
            const size = Math.min(container.clientWidth, container.clientHeight, 400);
            canvas.width = size;
            canvas.height = size;
        }

        /**
         * æ›´æ–°
         */
        function updateCheatTargetOptions() {
            const allMembers = members; 
            const selectableMembers = allMembers.filter(member => !EXCLUDED_NUMBERS.includes(member));

            hiddenCheatTarget.innerHTML = '<option value="">ï¼ˆé¸æŠãªã—ï¼šãƒ©ãƒ³ãƒ€ãƒ ï¼‰</option>'; 
            
            selectableMembers.forEach(member => { 
                const option = document.createElement('option');
                option.value = member;
                option.textContent = `å‡ºå¸­ç•ªå· ${member}`; 
                hiddenCheatTarget.appendChild(option);
            });

            if (forcedWinnerNumber && (!allMembers.includes(forcedWinnerNumber) || EXCLUDED_NUMBERS.includes(forcedWinnerNumber))) {
                resetCheat();
            } else if (forcedWinnerNumber) {
                 hiddenCheatTarget.value = forcedWinnerNumber;
            }
            updateCheatStatusDisplay();
        }

        /**
         * éƒ¨å“¡ãƒªã‚¹ãƒˆï¼ˆå‡ºå¸­ç•ªå·ï¼‰ã®æ›´æ–°ã¨ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã®å†æç”»
         */
        function updateMemberList() {
            const input = memberInput.value.trim();
            members = Array.from(new Set(input.split('\n').map(m => m.trim()).filter(m => m.length > 0)));

            memberCount.textContent = `ç¾åœ¨ã®å€™è£œè€…æ•°: ${members.length}å`;
            spinButton.disabled = members.length < 1; 
            
            updateCheatTargetOptions();

            if (members.length === 0) {
                statusMessage.textContent = "ãƒªã‚¹ãƒˆã«ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
            } else {
                statusMessage.textContent = "ãƒªã‚¹ãƒˆæ›´æ–°å®Œäº†ï¼ã€Œãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã™ï¼ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚";
            }

            resultDisplay.textContent = '';
            drawRoulette();
        }

        /**
         * ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆï¼ˆå††ã‚°ãƒ©ãƒ•ï¼‰ã®æç”»
         */
        function drawRoulette() {
            if (!ctx) return;
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) * 0.95;
            const totalMembers = members.length;
            
            if (totalMembers === 0) {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
                ctx.fillStyle = '#ccc';
                ctx.fill();
                ctx.font = '16px Inter';
                ctx.fillStyle = '#333';
                ctx.textAlign = 'center';
                ctx.fillText('ç•ªå·ã‚’ãƒªã‚¹ãƒˆã«å…¥åŠ›ã—ã¦ãã ã•ã„', centerX, centerY);
                return;
            }

            const arcSize = (2 * Math.PI) / totalMembers; 

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.save();
            ctx.translate(centerX, centerY);
            ctx.rotate(rotationAngle);
            ctx.translate(-centerX, -centerY);

            for (let i = 0; i < totalMembers; i++) {
                const startAngle = i * arcSize;
                const endAngle = (i + 1) * arcSize;
                
                const colorIndex = i % colors.length;
                let color = colors[colorIndex];

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2; 
                ctx.stroke();

                ctx.save();
                ctx.fillStyle = '#fff'; 
                ctx.font = 'bold 16px Inter';
                ctx.textAlign = 'right';

                const textAngle = startAngle + arcSize / 2;
                const textX = centerX + Math.cos(textAngle) * (radius * 0.65);
                const textY = centerY + Math.sin(textAngle) * (radius * 0.65);

                ctx.translate(textX, textY);
                ctx.rotate(textAngle + Math.PI / 2); 

                const name = members[i];
                ctx.fillText(name, 0, 0);

                ctx.restore();
            }

            ctx.beginPath();
            ctx.arc(centerX, centerY, radius * 0.1, 0, 2 * Math.PI);
            ctx.fillStyle = '#fef2f2';
            ctx.fill();
            ctx.strokeStyle = '#ef4444';
            ctx.lineWidth = 3;
            ctx.stroke();

            ctx.restore();
        }

        /**
         * ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
         */
        function animate() {
            if (!isSpinning) return;

            rotationAngle += spinVelocity;
            spinVelocity *= friction;

            if (spinVelocity < 0.0001) {
                isSpinning = false;
                spinVelocity = 0;
                
                rotationAngle = finalStopAngle;
                
                drawRoulette(); 
                determineWinner();
                return;
            }

            drawRoulette();
            requestAnimationFrame(animate);
        }

        /**
         * ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆã‚’å›ã™
         */
        function spinRoulette() {
            if (isSpinning || members.length === 0) {
                return;
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¥‘æ©Ÿã«AudioContextã‚’åˆæœŸåŒ–ï¼ˆè­¦å‘ŠéŸ³ç”¨ï¼‰
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }

            resultDisplay.textContent = '...å›è»¢ä¸­...';
            spinButton.disabled = true;

            const totalMembers = members.length;
            const arcSize = (2 * Math.PI) / totalMembers;

            const selectableMembers = members.filter(member => !EXCLUDED_NUMBERS.includes(member));

            if (selectableMembers.length === 0) {
                statusMessage.textContent = "ã‚¨ãƒ©ãƒ¼: error332";
                spinButton.disabled = false;
                resultDisplay.textContent = 'å¯¾è±¡è€…ãªã—';
                return; 
            }

            let winnerMember; 

            if (forcedWinnerNumber && selectableMembers.includes(forcedWinnerNumber)) {
                winnerMember = forcedWinnerNumber;
            } else {
                const randomIndexInSelectable = Math.floor(Math.random() * selectableMembers.length);
                winnerMember = selectableMembers[randomIndexInSelectable];
            }
            
            predeterminedWinner = winnerMember;

            const targetSegmentIndex = members.indexOf(winnerMember);
            const centerAngleC = targetSegmentIndex * arcSize + arcSize / 2;
            let targetRotation = -Math.PI / 2 - centerAngleC;

            targetRotation = targetRotation % fullCircle;
            if (targetRotation < 0) {
                targetRotation += fullCircle;
            }

            const minSpins = 10 + Math.floor(Math.random() * 6); 
            let baseSpinsAngle = Math.ceil(rotationAngle / fullCircle) * fullCircle;

            finalStopAngle = baseSpinsAngle + targetRotation + (fullCircle * minSpins);

            const rotationNeeded = finalStopAngle - rotationAngle;
            let v_initial = rotationNeeded * (1 - friction);
            
            if (v_initial < 0.2) { 
                v_initial = 0.2;
            }
            spinVelocity = v_initial;
            
            isSpinning = true;
            animate();
            statusMessage.textContent = "æŠ½é¸ã‚’å®Ÿæ–½ä¸­ï¼"; 
        }

        /**
         * å‹è€…ã‚’æ±ºå®šã—è¡¨ç¤º
         */
        function determineWinner() {
            const totalMembers = members.length;
            const winnerName = predeterminedWinner; 

            if (totalMembers === 0 || !winnerName) {
                spinButton.disabled = false;
                return;
            }

            resultDisplay.textContent = winnerName;
            spinButton.disabled = false;
            
            statusMessage.textContent = `å‡ºå¸­ç•ªå· ${winnerName} ã®æ–¹ã€ã‚«ã‚®é–‰ã‚ãŠé¡˜ã„ã—ã¾ã™ï¼`;
            
            predeterminedWinner = null;
        }

        /**
         * ï¼¿
         */
        function handleCheatModeClick() {
            clickCount++;
            clearTimeout(clickTimer);

            if (clickCount >= 3) {
                hiddenCheatPanel.style.display = (hiddenCheatPanel.style.display === 'none' || hiddenCheatPanel.style.display === '') ? 'block' : 'none';
                clickCount = 0; 
            } else {
                clickTimer = setTimeout(() => {
                    clickCount = 0;
                }, 1000); 
            }
        }

        /**
         * ï¼¿
         */
        function setCheat() {
            const selected = hiddenCheatTarget.value;

            if (selected && members.includes(selected)) {
                if (EXCLUDED_NUMBERS.includes(selected)) {
                     statusMessage.textContent = 'ã‚¨ãƒ©ãƒ¼: error331è¨­å®šã‚’è§£é™¤ã—ã¾ã—ãŸã€‚';
                     forcedWinnerNumber = null;
                     hiddenCheatTarget.value = '';
                } else {
                    forcedWinnerNumber = selected;
                    hiddenCheatPanel.style.display = 'none'; 
                }
            } else if (selected && !members.includes(selected)) {
                statusMessage.textContent = 'ã‚¨ãƒ©ãƒ¼: é¸æŠã•ã‚ŒãŸç•ªå·ã¯ç¾åœ¨ã®ãƒªã‚¹ãƒˆã«å­˜åœ¨ã—ã¾ã›ã‚“ã€‚ãƒªã‚¹ãƒˆã«è¿½åŠ ã—ã¦ãã ã•ã„ã€‚';
            } else {
                forcedWinnerNumber = null;
            }
            updateCheatStatusDisplay();
            drawRoulette(); 
        }

        /**
         * ï¼¿
         */
        function resetCheat() {
            forcedWinnerNumber = null;
            hiddenCheatTarget.value = '';
            updateCheatStatusDisplay();
            drawRoulette();
        }

        function updateCheatStatusDisplay() {
            if (forcedWinnerNumber) {
                cheatStatus.textContent = `ç¾åœ¨ã®è¨­å®š: å‡ºå¸­ç•ªå· ${forcedWinnerNumber} `;
                cheatStatus.classList.remove('text-yellow-700');
                cheatStatus.classList.add('text-green-700', 'font-bold');
            } else {
                cheatStatus.textContent = "ç¾åœ¨ã®è¨­å®š: é€šå¸¸æŠ½é¸";
                cheatStatus.classList.remove('text-green-700', 'font-bold');
                cheatStatus.classList.add('text-yellow-700');
            }
        }

        function resetList() {
            memberInput.value = '';
            members = [];
            resetCheat(); 
            hiddenCheatPanel.style.display = 'none'; 
            updateMemberList();
            resultDisplay.textContent = '';
            statusMessage.textContent = "éƒ¨å“¡ãƒªã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚";
        }

        /* -----------------------------------------------
           ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»è­¦å‘Šæ©Ÿèƒ½ï¼ˆDevToolså¯¾ç­–ï¼‰
           ----------------------------------------------- */

        // è­¦å‘ŠéŸ³ã‚’å†ç”Ÿã™ã‚‹é–¢æ•°ï¼ˆã‚µã‚¤ãƒ¬ãƒ³ã®ã‚ˆã†ãªéŸ³ï¼‰
        function playWarningSound() {
            try {
                if (!audioCtx) {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                if (audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }

                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();

                oscillator.type = 'sawtooth';
                oscillator.frequency.value = 440; 
                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);
                
                // éŸ³é‡è¨­å®š
                gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);

                // ã‚µã‚¤ãƒ¬ãƒ³
                const now = audioCtx.currentTime;
                for(let i=0; i<10; i++) {
                    oscillator.frequency.linearRampToValueAtTime(800, now + i*0.5);
                    oscillator.frequency.linearRampToValueAtTime(400, now + i*0.5 + 0.25);
                }

                oscillator.start();
                setTimeout(() => {
                    oscillator.stop();
                    if(isAlertTriggered) playWarningSound();
                }, 5000);

            } catch(e) {
                console.error("Audio warning failed", e);
            }
        }

        // è­¦å‘Šã‚’ç™ºå‹•ã™ã‚‹
        function triggerSecurityAlert() {
            if (isAlertTriggered) return;
            isAlertTriggered = true;
            
            devToolsAlert.style.display = 'flex';
            playWarningSound();
            
            // æ“ä½œå¦¨å®³
            setInterval(() => {
                debugger;
            }, 100);
        }

        // 1. å³ã‚¯ãƒªãƒƒã‚¯ç¦æ­¢
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });

        // 2. ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç¦æ­¢ï¼ˆç¶²ç¾…ç‰ˆï¼‰
        document.addEventListener('keydown', function(e) {
            // Macã®Commandã‚­ãƒ¼ã€Windowsã®Ctrlã‚­ãƒ¼
            const isCtrl = e.ctrlKey || e.metaKey; 
            const isShift = e.shiftKey;
            const isAlt = e.altKey; // Macã§ã¯Optionã‚­ãƒ¼

            // --- å…±é€š ---
            // F12 (DevTools)
            if (e.keyCode === 123) {
                e.preventDefault();
                triggerSecurityAlert();
                return false;
            }

            // --- é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ç³» (DevTools, Console, Elements) ---
            // Windows/Linux: Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C
            // Mac: Cmd+Option+I, Cmd+Option+J, Cmd+Option+C, Cmd+Shift+C
            // I:73, J:74, C:67, K:75
            if (
                (isCtrl && isShift && [73, 74, 67, 75].includes(e.keyCode)) || // Win/Linux & Mac(Shift)
                (isCtrl && isAlt && [73, 74, 67, 75].includes(e.keyCode))      // Mac(Option)
            ) {
                e.preventDefault();
                triggerSecurityAlert();
                return false;
            }

            // --- ã‚½ãƒ¼ã‚¹è¡¨ç¤ºç³» (View Source) ---
            // Windows/Linux: Ctrl+U
            // Mac: Cmd+Option+U, Cmd+U
            // U: 85
            if ((isCtrl && e.keyCode === 85) || (isCtrl && isAlt && e.keyCode === 85)) {
                e.preventDefault();
                triggerSecurityAlert();
                return false;
            }

            // --- ä¿å­˜ãƒ»å°åˆ·ç³» (ãƒšãƒ¼ã‚¸ã‚½ãƒ¼ã‚¹æµå‡ºãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå´©ã‚Œé˜²æ­¢) ---
            // Save: Ctrl+S / Cmd+S
            // Print: Ctrl+P / Cmd+P
            // S: 83, P: 80
            if (isCtrl && [83, 80].includes(e.keyCode)) {
                e.preventDefault();
                triggerSecurityAlert();
                return false;
            }
        });

        // 3. DevToolsæ¤œçŸ¥ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ‡ãƒãƒƒã‚¬ãƒ¼æ³•ï¼‰
        setInterval(function() {
            const start = performance.now();
            debugger; // DevToolsãŒé–‹ã„ã¦ã„ã‚‹ã¨ã“ã“ã§æ­¢ã¾ã‚‹
            const end = performance.now();
            
            if (end - start > 100) {
                triggerSecurityAlert();
            }
        }, 1000);

        
        // ãƒšãƒ¼ã‚¸ã®ãƒ­ãƒ¼ãƒ‰æ™‚
        window.onload = function() {
            initializeCanvas();
            memberInput.value = "";
            updateMemberList();
            updateCheatStatusDisplay();
            
            updateListButton.addEventListener('click', updateMemberList);
            resetListButton.addEventListener('click', resetList);
            spinButton.addEventListener('click', spinRoulette);
            window.addEventListener('resize', initializeCanvas); 
            
            // éš ã—ãƒ¢ãƒ¼ãƒ‰èµ·å‹•ãƒˆãƒªã‚¬ãƒ¼
            resultBox.addEventListener('click', handleCheatModeClick);
            setCheatButton.addEventListener('click', setCheat);
            resetCheatButton.addEventListener('click', resetCheat);

            memberInput.addEventListener('input', function() {
                this.value = this.value.replace(/[^0-9\n]/g, '');
            });
            
            document.body.addEventListener('click', function() {
                if (!audioCtx) {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                }
            }, { once: true });
        };

        document.addEventListener('DOMContentLoaded', initializeCanvas);

    </script>
</body>

</html>
